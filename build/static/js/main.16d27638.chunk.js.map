{"version":3,"sources":["components/Header.js","components/Message.jsx","components/Time.js","components/Notice.js","components/Content.js","App.js","index.js"],"names":["Header","react_default","a","createElement","class","Message","props","console","log","target","DISTRICT_QUERY","gql","_templateObject","react_apollo_browser_umd","query","variables","district","_ref","loading","error","data","className","modifiedData","weatherElement","i","length","j","time","Object","objectSpread","defineProperty","elementName","CI","startTime","locationName","map","date","split","MinT","parameter","parameterName","MaxT","parseInt","weatherIcon","Wx","parameterValue","PoP","Time","state","Date","_this2","this","setInterval","setState","getMonth","getDate","getHours","getMinutes","getSeconds","Component","Notice","onClick","handleClose","client","ApolloClient","uri","Content","notice","projection","d3","center","scale","geoGenerator","then","err","topojson","objects","features","selectAll","enter","append","on","e","setAttribute","changeTarget","__data__","properties","COUNTYENG","join","attr","_this3","height","width","components_Notice","Time_Time","React","App","key","value","components_Header","components_Content","changeState","bind","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.16d27638.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nfunction Header() {\r\n  return (\r\n    <div>\r\n      <nav class=\"navbar navbar-light bg-light\">\r\n        <span class=\"navbar-brand mb-0 h1\">Weather</span>\r\n      </nav>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Header;\r\n","import React from \"react\";\r\nimport gql from \"graphql-tag\";\r\nimport { Query } from \"react-apollo\";\r\nimport './style.css';\r\nexport default function Message(props) {\r\n  console.log(props.target);\r\n  const DISTRICT_QUERY = gql`\r\n    query DistrictQuery($district: String!) {\r\n      district(district: $district) {\r\n        locationName\r\n        weatherElement {\r\n          elementName\r\n          time {\r\n            startTime\r\n            parameter {\r\n              parameterName\r\n              parameterValue\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  `;\r\n  const weatherIcon = data => {\r\n    console.log(data);\r\n    return parseInt(data) === 1 ? (\r\n      <i className=\"fas fa-sun mr-2\" />\r\n    ) : parseInt(data) < 4 ? (\r\n      <i className=\"fas fa-cloud-sun mr-2\" />\r\n    ) : parseInt(data) < 8 ? (\r\n      <i className=\"fas fa-cloud mr-2\" />\r\n    ) : (\r\n      <i className=\"fas fa-cloud-showers-heavy mr-2\" />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Query query={DISTRICT_QUERY} variables={{ district: props.target }}>\r\n      {({ loading, error, data }) => {\r\n        if (loading) return <h4 className=\"d-none\">...loading</h4>;\r\n        if (error) return console.log(error);\r\n        console.log(data);\r\n        let modifiedData = [];\r\n        let weatherElement = data.district.weatherElement;\r\n        for (let i = 0; i < weatherElement.length; i++) {\r\n          for (let j = 0; j < weatherElement[j].time.length; j++)\r\n            modifiedData[j] = {\r\n              ...modifiedData[j],\r\n              [weatherElement[i].elementName]: weatherElement[i].time[j]\r\n            };\r\n        }\r\n        console.log(typeof modifiedData[0].CI.startTime);\r\n        console.log(modifiedData);\r\n        return (\r\n          <div className=\"card card_message \">\r\n            <div className=\"card-header\">{data.district.locationName}</div>\r\n            <div className=\"card-body d-flex justify-content-between\">\r\n              {modifiedData.map(data => {\r\n                let date = data.CI.startTime.split(/[\\s-:]/);\r\n                console.log(date);\r\n                return (\r\n                  <div className=\"px-2\">\r\n                    <div className=\"card-title font-bold\">\r\n                      {date[1]}/{date[2]}{\" \"}\r\n                      {date[3]}:{date[4]}\r\n                    </div>\r\n                    <div className=\"card-text\">\r\n                      <i className=\"fas fa-thermometer-half mr-2\" />\r\n                      {data.MinT.parameter.parameterName} -{\" \"}\r\n                      {data.MaxT.parameter.parameterName}\r\n                    </div>\r\n                    <div className=\"card-text\">\r\n                      {weatherIcon(data.Wx.parameter.parameterValue)}\r\n                      {data.PoP.parameter.parameterName}%\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        );\r\n      }}\r\n    </Query>\r\n  );\r\n}\r\n","import React, { Component } from \"react\";\r\n\r\nexport default class Time extends Component {\r\n  state = { date: new Date() };\r\n  componentDidMount() {\r\n    setInterval(\r\n      () => this.setState((state, props) => ({ date: new Date() })),\r\n      1000\r\n    );\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"text-dark ml-3\">\r\n        <i class=\"far fa-clock mr-3\" />\r\n        {this.state.date.getMonth()+1}/\r\n        {this.state.date.getDate()}{\" \"}\r\n        {this.state.date.getHours()}:\r\n        {this.state.date.getMinutes()}:\r\n        {this.state.date.getSeconds()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React from \"react\";\r\n\r\nfunction Notice(props) {\r\n  return (\r\n    <div className=\"card card_notice\">\r\n      <div className=\"card-header d-flex justify-content-between align-items-center\">\r\n        <span>Notice</span>\r\n        <i class=\"far fa-times-circle\" onClick={props.handleClose}/>\r\n      </div>\r\n      <div className=\"card-body\">請選擇縣市</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Notice;\r\n","import React from \"react\";\r\nimport * as d3 from \"d3\";\r\nimport * as topojson from \"topojson\";\r\nimport Message from \"./Message.jsx\";\r\nimport ApolloClient from \"apollo-boost\";\r\nimport { ApolloProvider } from \"react-apollo\";\r\nimport Time from \"./Time\";\r\nimport Notice from \"./Notice\";\r\nconst client = new ApolloClient({\r\n  uri: \"/graphql\"\r\n});\r\n\r\nclass Content extends React.Component {\r\n  state = {\r\n    notice: true\r\n  };\r\n  componentDidMount() {\r\n    var projection = d3\r\n      .geoMercator() // 產生projection\r\n      .center([120, 24.5]) // 設定位置\r\n      .scale(6000); // 設定大小\r\n\r\n    // 套用project至路徑產生器\r\n    var geoGenerator = d3.geoPath().projection(projection);\r\n\r\n    // 開啟檔案\r\n    d3.json(\"./taiwan.json\")\r\n      .then(\r\n        (data, err) =>\r\n          topojson.feature(data, data.objects[\"COUNTY_MOI_1070516\"]).features\r\n      )\r\n      .then(features => {\r\n        // Join the FeatureCollection's features array to path elements\r\n        console.log(features);\r\n        var u = d3\r\n          .select(\".map\")\r\n          .selectAll(\"path\")\r\n          .data(features);\r\n\r\n        // Create path elements and update the d attribute using the geo generator\r\n        u.enter()\r\n          .append(\"path\")\r\n          .on(\"mouseover\", e => {\r\n            d3.event.target.setAttribute(\"fill\", \"orange\");\r\n          })\r\n          .on(\"mouseout\", e => {\r\n            d3.event.target.setAttribute(\"fill\", \"black\");\r\n            // d3.select(this).attr(\"fill\");\r\n          })\r\n          .on(\"click\", () => {\r\n            this.props.changeTarget(\r\n              d3.event.target.__data__.properties.COUNTYENG.split(\" \").join(\"\")\r\n            );\r\n          })\r\n          .attr(\"d\", geoGenerator);\r\n      });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <ApolloProvider client={client}>\r\n        <div className=\"map-container position-relative\">\r\n          <svg className=\"map\" height=\"600px\" width=\"100%\" />\r\n          {this.props.target ? <Message target={this.props.target} /> : null}\r\n          {this.state.notice ? (\r\n            <Notice\r\n              handleClose={() => {\r\n                this.setState((state, props) => ({ notice: !state.notice }));\r\n              }}\r\n            />\r\n          ) : null}\r\n          <Time />\r\n        </div>\r\n      </ApolloProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Content;\r\n","import React, { Component } from \"react\";\nimport Header from \"./components/Header\";\nimport Content from \"./components/Content\";\n\nclass App extends Component {\n  state = {\n    target: null\n  };\n  changeState(key) {\n    return value =>\n      this.setState((state, props) => ({ ...state, [key]: value }));\n  }\n\n  render() {\n    return (\n      <div>\n        <Header />\n        <Content changeTarget={this.changeState(\"target\").bind(this)} target={this.state.target} />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}